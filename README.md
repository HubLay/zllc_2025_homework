# zllc_2025_homework
嵌入式新生在此提交作业和学习日志

核心功能： 电机编码器测速，ESP32与ROS数据的同时接收及错帧问题，电机速度的控制，麦轮底盘以及差速底盘下的运动学分析（比赛期间把麦轮换成了胶轮），增量式PID速度环控制。


软件整体的运行流程、数据流向和处理过程。
1.程序开始，先依次对电机，舵机，编码器通道等初始化。
2.默认模式（NowMode）下为自动模式（0），需要Robot Go切为遥控模式
3.手控模式下，在UART接收完成中断回调中调用ESP32_Analysis，对数据进行解析处理，进而调用Car_Solution中的系列函数将遥控数据映射到小车的实际控制上，Car_Solution中，实际上是调用Motor里的函数进行操作。
4.自动模式。通过ESP32在开启Robot Go下再次点击，关闭Robot Go ，可开启自动模式，并在ESP32_Analysis函数中开启第一次与上位机数据的接收。接收小车的需要的线速度和角速度。通过小车的底盘解算函数void Move_Transfrom，调用Set_ExSpeed函数，设定目标速度，进行PID控制。
5.自动模式下，通过444模拟开关，轮流对电机进行M法测速，使用了定时器2，并调用PID_Motor()函数，计算PWM，给到Set_Speed()函数，进行电机转速的实际控制。因为测量原理限制（444模拟开关），只能测两个电机转速，所以将速度映射。胶轮底盘下M1--->M4，M2---->M3；麦轮底盘下，M1--->M3，M2--->M4。

